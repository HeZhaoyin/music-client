"use strict";var e=require("../../../common/vendor.js"),t=require("../../../apis/music.js");require("../../../utils/request.js");const r=e.defineComponent({__name:"LrcArea",props:{musicID:{type:Number,required:!0},audioCurTime:{type:Number,required:!0}},setup(r,{expose:n}){const i=r,c=e.getCurrentInstance(),l=e=>{const t=/\./,r=parseInt(e.match(/.*:/)[0].slice(0,2));let n=parseInt(e.match(/:.*\./)[0].slice(1,3));const i=e.slice(e.match(t).index+1,e.match(t).index+3);return 0!==r&&(n+=60*r),Number(n+"."+i)};let u=e.ref([]);const o=e.ref(0);let s=e.ref(0),a=e.ref(500);e.watch((()=>i.audioCurTime),(t=>{if(0!=t&&t>u.value[o.value+1].time-.6&&(o.value++,c)){e.index.createSelectorQuery().in(c).select(`#lrcText${o.value}`).boundingClientRect((e=>{e&&e.height&&(s.value-=e.height),console.log(e)})).exec()}})),e.onMounted((()=>{})),t.getMusicLrcByID(i.musicID).then((e=>{console.log(e),u.value=(e=>{if(""===e)return{lyric:[{time:0,lyric:"这个地方没有歌词！",uid:520520}]};const t=[],r=null==e?void 0:e.split(/\n/),n=/\d{2}:\d{2}.\d{2,3}/;for(let i=0;i<(null==r?void 0:r.length);i++){if(""===r[i])continue;const e=l(r[i].match(n)[0]);""!==r[i].split("]")[1]&&t.push({time:e,lyric:r[i].split("]")[1],uid:parseInt(Math.random().toString().slice(-6))})}return console.log(t),{lyric:t}})(e.lrc.lyric).lyric}));return n({onBottomOpenChange:e=>{console.log("歌词组件触发了",e),a.value=e?200:500}}),(t,r)=>({a:e.f(e.unref(u),((t,r,n)=>({a:e.t(t.lyric),b:"lrcText"+r,c:e.n(o.value==r?"lrc-active":""),d:t.uid}))),b:e.s("top:"+e.unref(a)/2+"rpx;transform:translateY("+e.unref(s)+"px"),c:e.s("height:"+e.unref(a)+"rpx")})}});wx.createComponent(r);
